var L=r=>{throw TypeError(r)};var f=(r,t,e)=>t.has(r)||L("Cannot "+e);var i=(r,t,e)=>(f(r,t,"read from private field"),e?e.call(r):t.get(r)),s=(r,t,e)=>t.has(r)?L("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),n=(r,t,e,o)=>(f(r,t,"write to private field"),o?o.call(r,e):t.set(r,e),e),p=(r,t,e)=>(f(r,t,"access private method"),e);import{a as x,H as q,S as T,M as _,b as V}from"./SwitchPageController-DKU7_c70.js";var g,k;class D{constructor(t,e){s(this,g);this.productNameElement=document.querySelector(t.productName),this.productImagesSliderElement=document.querySelector(t.productImagesSlider),this.productMainImageElement=document.querySelector(t.productMainImage),this.productAboutElement=document.querySelector(t.productAbout),this.productFeedbackElement=document.querySelector(t.productFeedback),this.productPriceElement=document.querySelector(t.productPrice),this.productDescriptionElement=document.querySelector(t.productDescription),this.productButtonsBlock=document.querySelector(t.buttonsBlock),this.productMobileSliderElement=document.querySelector(e.productMobileSlider),this.productMobileLeftButtonElement=document.querySelector(e.productMobileLeftButton),this.productMobileRightButtonElement=document.querySelector(e.productMobileRightButton),this.htmlBuilder=new x}getName(t){return this.productNameElement.textContent=t}getImagesSlider(t){let e;return t.forEach((o,c)=>{e=this.htmlBuilder.createButton("","main-item__image"),c===0&&e.classList.add("active");const u=this.htmlBuilder.createImage(o);e.appendChild(u),this.productImagesSliderElement.appendChild(e)}),e}getMainImage(t){return this.productMainImageElement.src=t}getAbout(t){return this.productAboutElement.textContent=t}getFeedback(t){return this.productFeedbackElement.textContent=t}getPrice(t){return this.productPriceElement.textContent=t+" ₽"}getDescription(t){return this.productDescriptionElement.textContent=t}getMobileSlider(t){return t.forEach(e=>{this.productMobileSliderElement.appendChild(this.htmlBuilder.createImage(e))}),this.productMobileSliderElement}switchImages(){const t=this.productImagesSliderElement,e=t.querySelectorAll("button"),o=t.querySelectorAll("img");e.forEach((c,u)=>{c.addEventListener("click",()=>{e.forEach(M=>M.classList.remove("active")),c.classList.toggle("active"),this.productMainImageElement.src=o[u].src})})}addToVisited(t){const e=p(this,g,k).call(this);e.includes(Number(t))||(e.push(Number(t)),localStorage.setItem("visited",JSON.stringify(e)))}addToId(t){this.productButtonsBlock.setAttribute("data-product-id",t)}}g=new WeakSet,k=function(){let t=[];if(localStorage.getItem("visited"))try{t=JSON.parse(localStorage.getItem("visited")),Array.isArray(t)||(t=[])}catch{t=[]}return t};var l,y,d,a,E,m,S,w,h,I;class F{constructor(){s(this,h);s(this,l);s(this,y,new URLSearchParams(document.location.search));s(this,d,i(this,y).get("id"));s(this,a,0);s(this,E,300);s(this,m,20);s(this,S,{productName:"[data-product-name]",productImagesSlider:"[data-product-slider-images]",productMainImage:"[data-product-main-image]",productAbout:"[data-product-about]",productFeedback:"[data-prodcut-feedback]",productPrice:"[data-product-price]",productDescription:"[data-product-description]",buttonsBlock:".main-item__buttons"});s(this,w,{productMobileSlider:"[data-product-mobile-slider-images]",productMobileLeftButton:"[data-product-mobile-left-button]",productMobileRightButton:"[data-product-mobile-right-button]"});this.helpers=new q,this.view=new D(i(this,S),i(this,w)),this.init()}async init(){n(this,l,await this.helpers.getData()),this.getProduct(),this.view.switchImages(),this.addEventListenersToMobileButtons(),this.view.addToVisited(i(this,d)),this.helpers.addEventListenerToBuyButton("main-item__buttons","main-item__buy"),this.helpers.addEventListenerToFavoritesButton("main-item__buttons","main-item__favorit"),this.helpers.getCountBasket()}getProduct(){const t=i(this,l).find(A=>A.id==i(this,d)),{name:e,images:o,mainImage:c,about:u,feedback:M,price:N,description:P}=t;this.view.getName(e),this.view.getImagesSlider(o),this.view.getMainImage(c),this.view.getAbout(u),this.view.getFeedback(M),this.view.getPrice(N),this.view.getDescription(P),this.view.getMobileSlider(o),this.view.addToId(i(this,d))}addEventListenersToMobileButtons(){const t=this.view.productMobileSliderElement,e=t.querySelectorAll("img").length;this.view.productMobileLeftButtonElement.addEventListener("click",()=>{n(this,a,Math.max(0,i(this,a)-1)),p(this,h,I).call(this)}),this.view.productMobileRightButtonElement.addEventListener("click",()=>{n(this,a,Math.min(e-1,i(this,a)+1)),p(this,h,I).call(this)}),t.addEventListener("scroll",()=>{const o=t.scrollLeft;n(this,a,Math.round(o/(i(this,E)+i(this,m))))})}}l=new WeakMap,y=new WeakMap,d=new WeakMap,a=new WeakMap,E=new WeakMap,m=new WeakMap,S=new WeakMap,w=new WeakMap,h=new WeakSet,I=function(){const t=this.view.productMobileSliderElement,e=t.querySelectorAll("img");if(t.length===0)return;const o=e[0].clientWidth,c=i(this,m)||0;t.scrollTo({left:i(this,a)*(o+c),behavior:"smooth"})};class R{constructor(t){this.breadcrumbsCategoryElement=document.querySelector(t.breadcrumbsCategory),this.breadcrumbsTypeElement=document.querySelector(t.breadcrumbsType),this.breadcrumbsNameElement=document.querySelector(t.breadcrumbsName)}getCategory(t){switch(t.category){case"components":return this.breadcrumbsCategoryElement.href="./catalog.html?type=components",this.breadcrumbsCategoryElement.textContent="Компоненты ПК";case"other":return this.breadcrumbsCategoryElement.href="./catalog.html?type=other",this.breadcrumbsCategoryElement.textContent="Другая техника";case"accessories":return this.breadcrumbsCategoryElement.href="./catalog.html?type=accessories",this.breadcrumbsCategoryElement.textContent="Аксессуары"}}getType(t){const e=String(t.tags[0]),o=e.slice(0,1).toUpperCase(),c=e.slice(1).toLowerCase();return this.breadcrumbsTypeElement.href=` /TechnoPort/pages/catalog.html?type=search&search=${e}`,this.breadcrumbsTypeElement.textContent=o+c}getName(t){return this.breadcrumbsNameElement.textContent=t.name}}var b,v,C,B;class H{constructor(){s(this,b);s(this,v,new URLSearchParams(document.location.search));s(this,C,i(this,v).get("id"));s(this,B,{breadcrumbsCategory:"[data-breadcrumbs-category]",breadcrumbsType:"[data-breadcrumbs-type]",breadcrumbsName:"[data-breadcrumbs-name]"});this.helpers=new q,this.breadcrumbsView=new R(i(this,B)),this.init()}async init(){n(this,b,await this.helpers.getData()),this.getBreadcrumbs()}getBreadcrumbs(){const t=i(this,b).find(e=>e.id==i(this,C));this.breadcrumbsView.getCategory(t),this.breadcrumbsView.getType(t),this.breadcrumbsView.getName(t)}}b=new WeakMap,v=new WeakMap,C=new WeakMap,B=new WeakMap;new F;new H;new T;new _;new T;new V;
